(defpackage #:eu.turtleware.charming-clim
  (:use #:cl)
  (:export #:start-display))
(in-package #:eu.turtleware.charming-clim)

;; gcc raw-mode.c -shared -o raw-mode.so
;; (cffi:load-foreign-library "/path/to/raw-mode.so")

(cffi:defcfun (enable-raw "enable_raw")
    :pointer)

(cffi:defcfun (disable-raw "disable_raw")
    :void
  (handler :pointer))

(defvar *console-io* *terminal-io*)


(defun put (&rest args)
  "Put raw string on a console"
  (format *console-io* "狺狎珞ㄦ轭轶璀秕麴豸泔铙镬瀛轱┅ㄤ彐躅弩é蝈篝狎珞⑴筱狃箦聃孱沐ㄡ痧禊＇瘐＼弩狎珞┅ㄤ彐躅泱é蝈篝狎珞⒚镱趄镬箦聃孱沐轭趄镤蹉弪ㄡ痧禊＇弩＼狎珞┅ㄤ彐躅箸é蝈篝狎珞⒂屐邈球狃栝义钿轸轱睥ㄡ痧禊＇泱ㄡ痧孱狎珞Ж㈨┅┅ㄤ彐躅蝈箦舡泔铙镬ī⒚戾狎翳筱蝈孱狒趄殁豸弩沲蝮矧痫箝糸镱弭惝ㄥ筱恽┅ㄤ彐躅沆遽颦泔铙镬é镳糸镱犰盹溴博⑴蜥箦轭溟箴灬换腻骈铄盹溴蠛换沆遽骝镯沲蝮矧麸翳孱镦翳溟箴灬换沆遽骝镯沲蝮矧麸翳篝狎镦翳溟箴灬换沆遽孱糸蝈溟箴灬ㄣ箝盹溴⑹┅ㄤ彐躅沆遽颦扉铄é镳糸镱犰盹溴博⑴蜥箦轭扉铄换腻骈铄盹溴蠛换沆遽骝镯沲蝮矧麸翳孱镦翳扉铄换沆遽骝镯沲蝮矧麸翳篝狎镦翳扉铄换沆遽孱糸蝈扉铄ㄣ箝盹溴⑺┅ㄤ彐躅箦舡骘蝈珧秕钿泔祜猢箸⒊富不⒒⒒猢ㄤ彐躅箦舡忉汶珧秕钿泔祜猢箸⒋富不⒒⒒猢ㄤ彐躅筢鲥沲蝮矧痫箝糸镱īㄣ箝Ⅲ┅ㄤ彐躅蝈篝矧瀛沲蝮矧痫箝糸镱īㄣ箝Ⅴ┅ㄤ彐躅箦舡沲蝮矧痫箝糸镱蝻泔飑ㄣ镱è犷蝻泔飑ㄣ箝蝻⒒泔⑷┅è铒铛祆蝻鳗ㄣ箝蝻⒒娶┅è铒铛祆泔飑ㄣ箝⒒泔⑷┅┅ㄤ彐磲泸鏖翳沲蝮矧痫箝糸镱è蝻泔飑怙澌怙澌啜痱镧筢鲥沲蝮矧痫箝糸镱箦舡沲蝮矧痫箝糸镱蝻泔飑躅鏖钿痱雉邈痱镧棱镤蝈篝矧瀛沲蝮矧痫箝糸镱┅┅ㄤ彐躅箦翩沲蝮矧鲩箝忾扉豉鲩箝忪屦ㄩ鲩箝忪屦ㄣ箝⒖㈣ㄣ箝⒖㈧┅ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ彐泔铙翎铘溴戾翦ㄣ镤瀛汨狎ｘ锋⒃桢呐汨狎徙翦ǎ芤踱秕舂灬篝轭翳劣蒙翎忪瀹ㄤ彐泔铙翎铘弩汜疱ㄣ镤瀛汨狎ｘ扁⒃桢庞汨狎徙翦ǎ苠筱┊┅ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ彐泔铙翎铘惚盹浍倍ㄤ彐泔铙翎铘礤翎盹浍俯ㄤ彐泔铙翎铘泗蜢盹浍穿ㄤ彐疳蜥礤翦犰舡盹浍博ㄤ彐泔铙翎铘犰舡盹洫博ㄤ彐泔铙翎铘箬殒舡盹浍暴ㄤ彐躅箦翩犰舡轶礤翎ㄢ镲飑ㄩ怙镬箦翩犰舡盹浍礤翎盹浍箦翩犰舡盹浍犰舡盹洫┅ㄤ彐沆狍珏篝躜īè脲洪铋翎蜱弘妁横沣弩箫珏篝躜瀛脲盹潴洪铋翎蜱喉镤横沣弩箫珏篝躜瀛盹潴┅ㄤ彐礤翳镤痱轭舡镡赍泗è珏篝躜濠螬痱轭舡躅蝈徜徕戾镡赍泗呼疱铋洪溴铘轸铋飑戾è脲ㄧ弩趱蝈脲铹盹潴ㄧ弩趱蝈盹潴铹┅ㄦ矧磲螈脲祜镳骘轭扉篝惚盹浍礤翎盹浍泗蜢盹浍犰舡盹洫箬殒舡盹浍骘轭Ж好和弭好趄毫祠河栝骠躅戾篌弪镳祜玑钿盹潴皓泔祆邈氅┅┅ㄤ彐躅泔铘蝻飙汨狎ㄣ狨ㄣ镤ㄣ栳颦泔溴汨┅矧冀泔溴潮冀辈泔溴钡供┅ㄤ彐躅泔铘蝻祓ㄣ狨ㄣ镤ㄣ栳颦泔溴汨┅⑿蝈溟汜翦溴翦蝽轭轭殒翳汨狎徙翦轶泔铘蝻汨狎徙翦虍义趱蝾珏铄蜥扉邃怙镬遽麒孱趄蹂蝈趱蝾珏篝躜濠ㄣ镱è冀泔溴潮磲脲轭篝犷沐х弩趱蝈喉镤泗蜢盹浍弘妁ㄣ镤瀛汨狎ǐ泔溴洞┅┅è冀辈泔溴钡供磲脲轭篝犷沐х弩趱蝈喉镤惚盹浍弘妁ㄣ镤瀛汨狎ō泔溴洞┅┅┅ㄤ彐鲠脲蝈箫祧弪螵磲脲栳箬翎忪濠ㄤ彐磲泸溴骈铄脲蝈箫祧弪ㄧ蝻躔翦蝽轭狒矧铛肀铛聿怙澌怙澌啜箦翩ㄧ弭栳箬ǐㄣ栳颦泔溴翦蝽轭狒矧ㄡ箬ㄣ栳颦泔溴珧秕皓俯脲蝈箫祧弪螵灬礅溽ì铛肀铛聿ㄤ邈灬蝈ㄩ珙矧徕戾铛肀铛聿┅棱镤┅ㄤ彐躅磲忮泔礅脲铛聿ㄡ戾犷潋獒洪姝戾è泗蜢ㄡ钿ㄣ栳蜥泗弪脲ㄣ镱趄镬脲┅┅痱镧泗蜢箦翩ㄧ弩趱蝈盹潴泗蜢祜玳矧ū铛聿泗蜢盹浍┅矧ㄡ钿铛聿暴脲磲脲轭篝犷沐х弩趱蝈弘妁脲喉镤ū铛聿┅┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿戾è脲ㄣ狍铛肀ū鸿镯濠ú洪铙弪舂ǔ轰屐弭濠ù哄钿ǖ吼徵瀛躔ǘ吼徵瀛滹黝ū烘暴ū烘博ū烘畅ū烘穿溴痱邈狒邃ū烘旦ū烘订ū烘珐ū烘俯ú烘供ú烘卑ú烘北ú烘辈ú烘背ú烘贝ú烘钡ú烘倍ǔ烘狈ǔ烘备ǔ烘惫ǔ烘舶┅┅磲忮泔礅脲铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁躔铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁滹黝铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁蜷玷铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁戾骠铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐躅蝈箫祧瀛脲ㄧ蝻躔铛肀铛聿柔篝灬鲩篝岈忉怡ㄩ铛祆柔篝灬鲩篝岈忉怡换阻孱翳弪轶铒翦蝽轭狒轭汨狎徙翦颥翳孱轸轶痱镡徕禊换蝈篚祠镦痱弩箝铉撂垣笺栳蚓澡轶轶犴忾顼躞楫撂垣换珏铄蜥翦糜僧族趄麸忮狍蝻怩篝狍麇汜桢蝈磲忮泔礅ㄣ狍珧秕ǎ弩汜疱哄筱狃濠ǎ溴戾翦轰屐弭濠珧秕皓ū犰舡盹浍┅ㄦ躅汜祆ㄧ弭栳箬ǐㄣ栳颦泔溴柔篝灬鲩篝岈忉怡ㄡ箬ㄣ栳颦泔溴珧秕皓俯脲蝈箫祧弪螵＇灬礅溽铛肀铛聿戾èㄦ矧磲铋⒄铍铒黝箦聃孱沐庞恽珧秕铛肀铛聿柔篝灬鲩篝岈忉怡┅磲脲轭篝犷沐х弩趱蝈弘妁喉镤癌┅铛肀铛聿┅ㄤ彐躅疳蝮瀛弩汜疱箦聃孱沐ī戾è汨狎蝈徜汨狎铒栳铉泔铙镬瀛轱┅铛肀暴铛聿暴ㄦ戾è蝈徜铛ī祜镳麒殪ㄡ钿汨狎ㄤ殓轸汨狎汨狎┅泔祆邈糸铉汨狎轭麸铛滹箦翩汨狎蝈徜汨狎铒栳铉泔铙镬瀛轱┅骈钺祆麒孱铛蝈趱蝾疳蝮瀛轭翦珏ㄣ镥蜚铛篝蜷铉┅┅┅箦翩铛肀矧蝈徜铛愆暴麒孱铛祆汨狎蝈趱蝾骝镯疳蝮瀛弩汜疱箦聃孱沐鲠祯弩铛肀铛聿汨狎┅麒孱ㄣ栳蚪汨狎＼哗箦翩汨狎蝈徜汨狎铒栳铉泔铙镬瀛轱铛聿矧蝈徜铛愆暴┅鲠祯弩铛肀铛聿汨狎┅┅ㄤ彐躅弩汜疱ㄣ瑭躅戾篌ㄣ栳蚪汨弩汜疱蝈趱蝾骝镯弩汜疱铋飑ㄡ戾犷潋獒洪姝戾è铄舡汨蝈徜汨狎铒栳铉泔铙镬瀛轱┅换澡弩汜疱箦聃孱沐珧犴磲蚝圮畚陷碱蹴京患铛砭┷镰谳眭祠轲戾鲠祯瀛忾钿铛肀铛聿翦蝽轭狒矧疳蝮瀛弩汜疱箦聃孱沐蝈箫祧瀛脲铄舡汨铛肀铛聿翦蝽轭狒矧┅哄筱狃濠ㄤ彐躅溴戾翦ㄣ瑭麒孱ㄣ栳蚪汨溴戾翦轰屐弭濠ㄤ彐躅蝈徜轭瘐é狨ㄣ蝈徜汨狎铒栳铉泔铙镬瀛轱┅换遗聊萌烈磲蝈徜盹蝈翳犷镱怡翦犷蝈趱蝾犷犰痂犷蹴弪殂换汨狎徙翦虍澡狒骈铄忮汜躞麇鏖祆蝈趱蝾轸狍轶翳孱ㄣ镱è矧铛祆汨ㄧ蜥痂殂汨狎汨┅蝈趱蝾骝镯蝈徜轭瘐汨┅è溴戾翦汨┅è弩汜疱汨┅è泔铘蝻祓汨┅ㄥ蝌矧⒄铍铒黝轭瘐箦聃孱沐汨狎泔溴傍ギㄣ栳颦泔溴汨┅┅ㄤ彐磲泸鏖翳泔铙镬镳趔怙澌怙澌ㄤ邈灬蝈ㄩ珙矧镳趔┅戾è栳钿戾ㄧ孱簌愆┅啜戾è栳钿戾ㄥ钺忪瀛蜥鳗┅躅鏖钿痱雉邈痱镧棱镤ㄤ轶徕戾蜥栳钿戾颟┅┅ㄤ彐疳蜥礤翦泔铈扉篝后戾屦悲栋恒躜箫蝠铋烘矧彗蝻躅Жｘ骀ｘ岚ｘ岚衡徙腌蝻躅Жｘ鞍ｘ膊ｘ膊┅ㄤ邈灬轫铒糸铎轭箬秣筱蝈孱┅戾è汨狎徙翦蝮铋飑ㄤ彐躅箬秣筱蝈孱ī祜镳骘汨蝈徜轭瘐舂躅糸铛祆汨滹瘐箬汨汨狎徙翦蝮┅箦翩汨狎徙翦蝮篚怏羼汨狎徙翦蝮黹辈戾铉翳汨狎徙翦蝮┅┅箦舡沲蝮矧痫箝糸镱ū蜥钿镯辈┅ū蜥钿镯窗┅ㄩ弪镳蜥钿镯博瘐瘐┅鏖翳沲蝮矧痫箝糸镱ū创祜镳骘蝻骝镯骘汨轭汨狎徙翦蝮滹箦舡沲蝮矧痫箝糸镱蝻创ㄦ矧磲泔铙镬瀛轱ㄦ矧磲铋⒁遽浜螈汨┅ㄣ戾狎扉铄癌┅┅ㄤ彐躅篝狎舡溟箴灬ī篦犷牒泸遽翦箦蝣弪鏖翳泔铙镬ī祜镳鏖翳泔铈鏖翳箦泔钿滹躅戾篌ㄥ聃犰泔铈泔铈箦翩泔铈ㄣ镳扉篝泔铈┅ㄤ弩趄蹉趱蜷铉忾钿é脲箪邋沲蝮矧骘蝈珧秕钿忉汶珧秕钿泔铈箦翩箦泔钿箪邋皓蝈箦舡泔铙镬濠箦翩ㄣ躜箫颦鲩箝忾扉豉沲蝮矧皓ㄡ痧禊＇箦舡忉汶珧秕钿泔祜忉汶珧秕钿ㄡ痧禊＇箦舡骘蝈珧秕钿泔祜骘蝈珧秕钿ㄣ戾狎泔铙镬濠┅箪邋箦泔钿螬箬秣筱蝈孱┅┅