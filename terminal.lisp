(defpackage #:eu.turtleware.charming-clim
  (:use #:cl)
  (:export #:with-console #:out #:ctl))
(in-package #:eu.turtleware.charming-clim)

;; gcc raw-mode.c -shared -o raw-mode.so
;; (cffi:load-foreign-library "/path/to/raw-mode.so")

(cffi:defcfun (enable-raw "enable_raw")
    :pointer)

(cffi:defcfun (disable-raw "disable_raw")
    :void
  (handler :pointer))

(cffi:defcfun (enable-sigwinch "enable_sigwinch")
    :pointer
  (callback :pointer))

(cffi:defcfun (disable-sigwinch "disable_sigwinch")
    :void
  (handler :pointer))

(cffi:defcallback sigwinch :void
    ((signum :int))
  (declare (ignore signum))
  (update-console-dimensions))


(defmacro letf (bindings &body body)
  (loop for (place value) in bindings
        for old-val = (gensym)
        collect `(,old-val ,place)      into saves
        collect `(setf ,place ,value)   into store
        collect `(setf ,place ,old-val) into restore
        finally (return `(let (,@saves)
                           (unwind-protect (progn ,@store ,@body)
                             ,@restore)))))

(defvar *row1* '(1))
(defvar *col1* '(1))
(defvar *row2* '(24))
(defvar *col2* '(80))
(defvar *fun* (list (constantly t)))

(defmacro with-clipping ((&key fun row1 col1 row2 col2) &body body)
  `(let (,@(when row1 `((*row1* (cons (max (car *row1*) ,row1) *row1*))))
         ,@(when col1 `((*col1* (cons (max (car *col1*) ,col1) *col1*))))
         ,@(when row2 `((*row2* (cons (min (car *row2*) ,row2) *row1*))))
         ,@(when col2 `((*col2* (cons (min (car *col2*) ,col2) *col2*))))
         ,@(when fun  `((*fun*  (cons (let ((old (car *fun*)))
                                        (lambda (row col)
                                          (and (funcall ,fun row col)
                                               (funcall old row col))))
                                      *fun*)))))
     ,@body))

(defun inside (row col)
  (and (<= (car *row1*) row (car *row2*))
       (<= (car *col1*) col (car *col2*))
       (funcall (car *fun*) row col)))

(defmacro out ((&key row col fgc bgc) object)
  "Put an object on a console"
  `(let ((str (princ-to-string ,object)))
     (assert (null (find #\newline str)))
     (letf (((pos *console*) (cons (or ,row (car (pos *console*)))
                                   (or ,col (cdr (pos *console*)))))
            ,@(when fgc `(((fgc *console*) ,fgc)))
            ,@(when bgc `(((bgc *console*) ,bgc))))
       (let* ((pos (pos *console*))
              (row (car pos))
              (col (cdr pos)))
         (loop for c from col
               for s across str
               when (inside row c)
                 do (put s))))))

(defmacro ctl (&rest operations)
  `(progn
     ,@(loop for op in operations
             collect (destructuring-bind (name &rest args) op
                       (ecase name
                         (:clr `(clear-rectangle ,@args))
                         (:fgc `(setf (fgc *console*) (list ,@args)))
                         (:bgc `(setf (bgc *console*) (list ,@args)))
                         (:cvp `(setf (cursor-visibility) ,@args))
                         (:ptr `(setf (mouse-tracking) ,@args))
                         (:pos `(setf (pos *console*) (cons ,(car args)
                                                            ,(cdr args)))))))))


(eval-when (:compile-toplevel :load-toplevel :execute)
  (defconstant +delete+ (code-char #x7f)
    "The DEL character (#\Rubout), last in the ASCII table.")
  (defconstant +escape+ (code-char #x1b)
    "The ESC character (#\esc)."))

(defun put (&rest args)
  "Put raw string on a console"
  (format *console-io* "狺狎珞ㄦ轭轶璀秕麴豸泔铙镬瀛轱┅ㄤ彐躅弩é蝈篝狎珞⑴筱狃箦聃孱沐ㄡ痧禊＇瘐弩汜疱狎珞┅ㄤ彐躅泱é蝈篝狎珞⒚镱趄镬箦聃孱沐轭趄镤蹉弪ㄡ痧禊＇弩＼狎珞┅ㄤ彐躅箸é蝈篝狎珞⒂屐邈球狃栝义钿轸轱睥ㄡ痧禊＇泱ㄡ痧孱狎珞Ж㈨┅┅ㄤ彐躅蝈箦舡泔铙镬ī⒚戾狎翳筱蝈孱狒趄殁豸弩沲蝮矧痫箝糸镱弭惝ㄥ筱恽┅ㄤ彐躅沆遽颦泔铙镬é镳糸镱犰盹溴博⑴蜥箦轭溟箴灬换腻骈铄盹溴蠛换沆遽骝镯沲蝮矧麸翳孱镦翳溟箴灬换沆遽骝镯沲蝮矧麸翳篝狎镦翳溟箴灬换沆遽孱糸蝈溟箴灬ㄣ箝盹溴⑹┅ㄤ彐躅沆遽颦扉铄é镳糸镱犰盹溴博⑴蜥箦轭扉铄换腻骈铄盹溴蠛换沆遽骝镯沲蝮矧麸翳孱镦翳扉铄换沆遽骝镯沲蝮矧麸翳篝狎镦翳扉铄换沆遽孱糸蝈扉铄ㄣ箝盹溴⑺┅ㄤ彐躅沆遽颦蝈泗犷珈虮惚虿悴祜镳鏖翳篝磲脲篝蜷铉ūō悴惚┅洪铋糸犰屐屙孱＼箴徙濠骘骝镯虮躔麸虿滹秕ê蝻恒镬惚篝颟┅ㄤ彐躅箦舡骘蝈珧秕钿泔祜猢箸⒊富不⒒⒒猢ㄤ彐躅箦舡忉汶珧秕钿泔祜猢箸⒋富不⒒⒒猢ㄤ彐躅筢鲥沲蝮矧痫箝糸镱īㄣ箝Ⅲ┅ㄤ彐躅蝈篝矧瀛沲蝮矧痫箝糸镱īㄣ箝Ⅴ┅ㄤ彐躅箦舡沲蝮矧痫箝糸镱蝻泔飑ㄣ镱è犷蝻泔飑ㄣ箝蝻⒒泔⑷┅è铒铛祆蝻鳗ㄣ箝蝻⒒娶┅è铒铛祆泔飑ㄣ箝⒒泔⑷┅┅ㄤ彐磲泸鏖翳沲蝮矧痫箝糸镱è蝻泔飑怙澌怙澌啜痱镧筢鲥沲蝮矧痫箝糸镱箦舡沲蝮矧痫箝糸镱蝻泔飑躅鏖钿痱雉邈痱镧棱镤蝈篝矧瀛沲蝮矧痫箝糸镱┅┅ㄤ彐躅箦翩沲蝮矧鲩箝忾扉豉鲩箝忪屦ㄩ鲩箝忪屦ㄣ箝⒖㈣ㄣ箝⒖㈧┅换ㄣ箝趄徙腴铉孱泔溟铉璇飑换趄徙腴铉卑鞍铒蝽犰卑安怩趑镱卑俺犰盹糸镱换卑按骘沲轭秕换孱泔溟铉卑岸箸孱泔溟铉筱桢礤ㄤ彐躅箦翩盹躞瀛趄徙腴铉ㄥ钺忪邃皓ㄩ孱徕戾漯ㄣ箝⒖卑俺⒒卑岸㈣ㄣ箝⒖卑俺㈧┅ㄤ彐躅蝈聃弩舡沲蝮矧痫箝糸镱īㄣ箝㈩┅ㄥ鲠飙麒孱ê泔眇殪瀛麸痨弼屐红镝洵麸痨弼屐哄邈豸濠ㄤ彐泔铙翎铘惚盹浍倍ㄤ彐泔铙翎铘礤翎盹浍俯ㄤ彐泔铙翎铘泗蜢盹浍穿ㄤ彐疳蜥礤翦犰舡盹浍博ㄤ彐泔铙翎铘犰舡盹洫博ㄤ彐泔铙翎铘箬殒舡盹浍暴ㄤ彐躅箦翩犰舡轶礤翎ㄢ镲飑ㄩ怙镬箦翩犰舡盹浍礤翎盹浍箦翩犰舡盹浍犰舡盹洫┅ㄤ彐沆狍珏篝躜īè脲洪铋翎蜱弘妁横沣弩箫珏篝躜瀛脲盹潴洪铋翎蜱喉镤横沣弩箫珏篝躜瀛盹潴┅ㄤ彐礤翳镤痱轭舡镡赍泗è珏篝躜濠螬痱轭舡躅蝈徜徕戾镡赍泗呼疱铋洪溴铘轸铋飑戾è脲ㄧ弩趱蝈脲铹盹潴ㄧ弩趱蝈盹潴铹┅ㄦ矧磲螈脲祜镳骘轭扉篝惚盹浍礤翎盹浍泗蜢盹浍犰舡盹洫箬殒舡盹浍骘轭Ж好和弭好趄毫祠河栝骠躅戾篌弪镳祜玑钿盹潴皓泔祆邈氅┅┅ㄤ彐躅泔铘蝻飙汨狎ㄣ狨ㄣ镤ㄣ栳颦泔溴汨┅矧冀泔溴潮冀辈泔溴钡供┅ㄤ彐躅泔铘蝻祓ㄣ狨ㄣ镤ㄣ栳颦泔溴汨┅⑿蝈溟汜翦溴翦蝽轭轭殒翳汨狎徙翦轶泔铘蝻汨狎徙翦虍义趱蝾珏铄蜥扉邃怙镬遽麒孱趄蹂蝈趱蝾珏篝躜濠ㄣ镱è冀泔溴潮磲脲轭篝犷沐х弩趱蝈喉镤泗蜢盹浍弘妁ㄣ镤瀛汨狎ǐ泔溴洞┅┅è冀辈泔溴钡供磲脲轭篝犷沐х弩趱蝈喉镤惚盹浍弘妁ㄣ镤瀛汨狎ō泔溴洞┅┅┅ㄤ彐鲠脲蝈箫祧弪螵磲脲栳箬翎忪濠ㄤ彐磲泸溴骈铄脲蝈箫祧弪ㄧ蝻躔翦蝽轭狒矧铛肀铛聿怙澌怙澌啜箦翩ㄧ弭栳箬ǐㄣ栳颦泔溴翦蝽轭狒矧ㄡ箬ㄣ栳颦泔溴珧秕皓俯脲蝈箫祧弪螵灬礅溽ì铛肀铛聿ㄤ邈灬蝈ㄩ珙矧徕戾铛肀铛聿┅棱镤┅ㄤ彐躅磲忮泔礅脲铛聿ㄡ戾犷潋獒洪姝戾è泗蜢ㄡ钿ㄣ栳蜥泗弪脲ㄣ镱趄镬脲┅┅痱镧泗蜢箦翩ㄧ弩趱蝈盹潴泗蜢祜玳矧ū铛聿泗蜢盹浍┅矧ㄡ钿铛聿暴脲磲脲轭篝犷沐х弩趱蝈弘妁脲喉镤ū铛聿┅┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿戾è脲ㄣ狍铛肀ū鸿镯濠ú洪铙弪舂ǔ轰屐弭濠ù哄钿ǖ吼徵瀛躔ǘ吼徵瀛滹黝ū烘暴ū烘博ū烘畅ū烘穿溴痱邈狒邃ū烘旦ū烘订ū烘珐ū烘俯ú烘供ú烘卑ú烘北ú烘辈ú烘背ú烘贝ú烘钡ú烘倍ǔ烘狈ǔ烘备ǔ烘惫ǔ烘舶┅┅磲忮泔礅脲铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁躔铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁滹黝铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁蜷玷铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅弘妁戾骠铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛脲蝈箫祧弪＼＼铛肀铛聿磲忮泔礅烘铛聿┅ㄤ彐轭瀛泔钿轸轱沲蝮矧痫箝糸镱蝈痫螋īè蝻洪铋翎蜱候秣候遽溴蝻鳗ㄣ镬洪铋翎蜱恒镬候遽溴泔飑┅ㄤ彐轭瀛脲蝈箫祧弪＼＼蝻泔飑箝珙犰с躜箫颦痫箝糸镱蝈痫螋候秣蝻恒镬泔飑磲脲轭篝犷沐х弩趱蝈弘妁ㄦ矧磲铋⒚躜箫痫箝糸镱螈蝻泔飑喉镤癌ㄤ彐躅蝈箫祧瀛脲ㄧ蝻躔铛肀铛聿柔篝灬鲩篝岈忉怡ㄩ铛祆柔篝灬鲩篝岈忉怡换阻孱翳弪轶铒翦蝽轭狒轭汨狎徙翦颥翳孱轸轶痱镡徕禊换蝈篚祠镦痱弩箝铉撂垣笺栳蚓澡轶轶犴忾顼躞楫撂垣换珏铄蜥翦糜僧族趄麸忮狍蝻怩篝狍麇汜桢蝈磲忮泔礅ㄣ狍珧秕ǎ弩汜疱哄筱狃濠ǎ溴戾翦轰屐弭濠珧秕皓ū犰舡盹浍┅ㄦ躅汜祆ㄧ弭栳箬ǐㄣ栳颦泔溴柔篝灬鲩篝岈忉怡ㄡ箬ㄣ栳颦泔溴珧秕皓俯脲蝈箫祧弪螵＇灬礅溽铛肀铛聿戾èㄦ矧磲铋⒄铍铒黝箦聃孱沐庞恽珧秕铛肀铛聿柔篝灬鲩篝岈忉怡┅磲脲轭篝犷沐х弩趱蝈弘妁喉镤癌┅铛肀铛聿┅ㄤ彐躅蝈箫祧瀛盹躞ㄢ纛泔蝻柔篝灬鲩篝岈忉怡戾è篝狒ㄣ镱è铒弪镳熹ㄣ镱旦怍瞟┅喉雉轱瞟è汨狎＼柔篝灬鲩篝岈忉怡吼蝈篌è汨狎＼柔篝灬鲩篝岈忉怡候屐遽箦┅盹潴ǐㄩ弪镳熹ㄣ镱博怍瞟箬殒舡盹浍ㄩ弪镳熹ㄣ镱畅怍瞟犰舡盹浍ㄩ弪镳熹ㄣ镱穿怍瞟泗蜢盹浍┅脲ㄣ狍ǐ熹ㄣ镱癌怍瞟ㄡ箬熹ㄣ镱订怍瞟博ǎ獍鞍红彐舂ǎ獍鞍喉殇潇濠ǎ獍氨候殓梏ǎ獍氨侯镱濠换洞ǎ獍卑瑚桢屐躔ǎ獍卑瑚桢屐滹黝ǎ獍北瑚桢屐戾骠ǎ獍北瑚桢屐蜷玷舂换辈翦蝽窘炒暴ǎ獗鞍哄趄岘暴ǎ獗鞍哄趄岘博ǎ獗氨哄趄岘畅ǎ獗氨哄趄岘穿┅磲脲轭篝犷沐х弩趱蝈弘妁ㄦ矧磲铋Ⅱ秣蹭泔旌蹭埝彷幄蝻泔脲怍篝狒濠喉镤盹潴┅ㄤ彐躅疳蝮瀛弩汜疱箦聃孱沐é狨汨狎ㄦ戾è蝈徜铛ī祜镳麒殪ㄡ钿汨狎ㄤ殓轸汨狎汨狎┅泔祆邈糸铉汨狎轭麸铛滹箦翩汨狎蝈徜汨狎铒栳铉泔铙镬瀛轱┅骈钺祆麒孱铛蝈趱蝾疳蝮瀛轭翦珏ㄣ镥蜚铛篝蜷铉┅┅┅祜镳滹箦翩汨狎蝈徜汨狎铒栳铉泔铙镬瀛轱┅泔祆邈矧蝈徜铛愆暴轭麸铛眢躅糸矧铛祆汨狎ㄣ栳虔＼汨狎┅骈钺祆蝈趱蝾鲠祯弩铛眢汨狎┅┅ㄤ彐躅弩汜疱ㄣ瑭躅戾篌ㄣ栳蚪汨弩汜疱蝈趱蝾骝镯弩汜疱铋飑ㄡ戾犷潋獒洪姝戾è铄舡汨蝈徜汨狎铒栳铉泔铙镬瀛轱┅换脲泔溴圮畚陷碱蹴京患铛砭┷镰谳换忧盹躞搴йЪ铛Щ铛Щ铛Щ弁磔ㄩㄡ钿ㄣ栳蚪＼铄舡汨ㄣ栳蚪＼疱咫汨狎泔铙镬瀛轱铋＼┅蝈徜汨狎铒栳铉泔铙镬瀛轱┅眭祠轲戾鲠祯瀛忾钿铛眢翦蝽轭狒矧疳蝮瀛弩汜疱箦聃孱沐ㄤ弩趄蹉趱蜷铉忾钿铛肀铛聿铛沓铛眢蝈箫祧瀛盹躞铛肀铛聿铛沓翦蝽轭狒矧┅眭祠轲戾鲠祯瀛忾钿铛眢翦蝽轭狒矧疳蝮瀛弩汜疱箦聃孱沐ㄤ弩趄蹉趱蜷铉忾钿é镳糸镱犰铛肀暴铛聿暴铛眢蝈箫祧瀛脲铄舡汨铛肀铛聿翦蝽轭狒矧┅┅哄筱狃濠ㄤ彐躅溴戾翦ㄣ瑭麒孱ㄣ栳蚪汨溴戾翦轰屐弭濠ㄤ彐躅蝈徜轭瘐é狨ㄣ蝈徜汨狎铒栳铉泔铙镬瀛轱┅换遗聊萌烈磲蝈徜盹蝈翳犷镱怡翦犷蝈趱蝾犷犰痂犷蹴弪殂换汨狎徙翦虍澡狒骈铄忮汜躞麇鏖祆蝈趱蝾轸狍轶翳孱ㄣ镱è矧铛祆汨ㄧ蜥痂殂汨狎汨┅蝈趱蝾骝镯蝈徜轭瘐汨┅è溴戾翦汨┅è弩汜疱汨┅è泔铘蝻祓汨┅ㄥ蝌矧⒄铍铒黝轭瘐箦聃孱沐汨狎泔溴傍ギㄣ栳颦泔溴汨┅┅ㄤ彐躅脲ㄣ脲蝈篝盹潴ㄩ铛祆盹潴ㄥ耢汨脲ㄡ钿豉疱汨х弩趱蝈ㄥ耢ㄧ弩趱蝈脲汨脲ㄥ耢ㄧ弩趱蝈盹潴汨祜镳骘轭盹潴篚眄轭ㄥ汜箦ê惚惚盹浍ê礤翎盹浍ê泗蜢盹浍ê犰舡盹洫ê箬殒舡盹浍┅┅┅ㄤ彐鲠泔铙镬濯ㄤ彐鲠泔铙镬瀛轱ㄤ彐鲠泔铙镬瀛溟螋皙舂ㄤ彐躅轭轸泔铙镬ī痱镧扉篝ㄥ钺忪瀛蜥鳗ㄥ钺忪瀛箝琪轭汨ㄣ骀楹汜祆忉汶箝琪轭汨┅蝈箦舡泔铙镬濠┅ㄤ彐躅沆矬瀛泔铙镬ㄨ犷潇弪蝈箦舡泔铙镬濠ㄤ弩趄蹉趱蜷铉忾钿翦蝽轱箝玑泗轱瞟栳钿戾ㄤ轶徕戾箝琪轭汨箝玑泗轱瞟ㄤ轶徕戾蜥翦蝽轱螬┅ㄤ彐躅珏舡沲蝮矧痫箝糸镱ī蝈聃弩舡沲蝮矧痫箝糸镱ㄨ犷潇弪汜箦祜镳蝈徜轭瘐舂ㄣ躜箫颦痫箝糸镱蝈痫螋ㄣ鲠祯弩蝻悌ㄣ镬悌┅┅ㄤ彐躅躔溽翦泔铙镬瀛溟礤铙轱铙īㄩㄢ秕钿И泔铙镬濯鏖翳沲蝮矧痫箝糸镱è屮痿倍ㄥ痿倍┅眭祠轲戾鲠祯瀛忾钿蝻黧泔祗ㄧ弭沲蝮矧痫箝糸镱箦翩蝻黧泔铙镬濯蝻黧ㄣ镬泔铙镬濯泔祗蝻鞑扉篝蝻黧泔觳扉篝泔祗┅箦翩泔铙镬瀛溟螋皙铋飑┅箦翩泔铙镬瀛溟螋皙舂┅ㄤ彐沆狍泔铙镬īè轱洪铋翎蜱洪矬横沣弩箫轱轰镢蹴孱翎糸镱⒚镱箫戾莎篝蝈犴ㄦ玢洪铋翎蜱烘玢横沣弩箫骁轰镢蹴孱翎糸镱⑵矧彗矧躅泔祜虍ㄢ玢洪铋翎蜱衡玢横沣弩箫忡轰镢蹴孱翎糸镱⒙徙腌蝻躅泔祜虍痫洪铋翎蜱吼矬横沣弩箫痫轰镢蹴孱翎糸镱⒚躜箫痫箝糸镱ㄣ鲳洪铋翎蜱恒鲳横沣弩箫泠轰镢蹴孱翎糸镱⒚躜箫鲩箝忾扉豉痿洪铋翎蜱吼趄横沣弩箫痿轰镢蹴孱翎糸镱⑿镩铘弪趄徙腴铉ㄦ痼洪铋翎蜱烘痼横沣弩箫骛轰镢蹴孱翎糸镱⒛弩轵邃骝犴弪狒瀹ㄡ痧洪铋翎蜱横痧横沣弩箫狃轰镢蹴孱翎糸镱⒘痧扉汜糸镱篝狒瀹ㄨ钿横沣弩箫桀轰镢蹴孱翎糸镱⒃弪黹钺栳钿戾虍蝻黧横沣弩箫蝻黧轰镢蹴孱翎糸镱⒃弪黹钺铛礅弪镦蝻黧ㄣ镬横沣弩箫泔祗轰镢蹴孱翎糸镱⒃弪黹钺铛礅弪镦泔祗┅ê溴驷蹯舡轭轸狎珞洪矬ㄥ蝌矧⑸篝蝈犴眭篝忮箴邈殒殄洚烘玢Жｘ骀ｘ岚ｘ岚衡玢Жｘ膊ｘ膊ｘ膊吼矬Ж暴恒鲳铋吼趄烘痼卑横痧铋飑ㄤ彐礤翳镤轭轸獒扉瀛轭篝犷沐横骠弪è轭篝犷沐泔铙镬濠脲骁忡痫泠痿颟箦翩ㄨ钿轭篝犷沐ㄩ铋舡泔铙镬濠ㄡ痧禊＇箦舡骘蝈珧秕钿泔祜骁悌ㄡ痧禊＇箦舡忉汶珧秕钿泔祜忡悌箦舡沲蝮矧痫箝糸镱ㄣ狎痫螬ㄣ潋痫螬箦翩ㄣ躜箫颦鲩箝忾扉豉泠皓箦翩盹躞瀛趄徙腴铉痿颟戾è泔铙镬濯轭篝犷沐┅躔溽翦泔铙镬瀛溟礤铙轱铙┅ㄤ彐礤翳镤箦翩骁悌横骠弪蜱ㄩ铙翎钽泔铙镬濠ㄡ痧禊＇箦舡骘蝈珧秕钿泔祜蜱猢ㄤ彐礤翳镤箦翩忡悌横骠弪蜱ㄩ铙翎钽泔铙镬濠ㄡ痧禊＇箦舡忉汶珧秕钿泔祜蜱猢ㄤ彐礤翳镤箦翩痫螬衡彐矧痫ㄩ铙翎钽泔铙镬濠ㄣ桢汶豉疱ㄣ狎痫螬ㄩ铘彗弪暴ㄣ桢汶豉疱ㄣ潋痫螬ㄩ铘彗弪暴┅ㄤ彐礤翳镤箦翩痫螬横骠弪痫ㄩ铙翎钽泔铙镬濠箦舡沲蝮矧痫箝糸镱ㄣ狎痫螬ㄣ潋痫螬┅ㄤ彐礤翳镤箦翩痿颟横骠弪痿ㄩ铙翎钽泔铙镬濠箦翩盹躞瀛趄徙腴铉铒铛祆痿颟┅ㄤ彐礤翳镤箦翩泠皓横骠弪ㄣ鲳ㄩ铙翎钽泔铙镬濠箦翩ㄣ躜箫颦鲩箝忾扉豉铒铛祆泠皓┅ㄤ彐磲泸鏖翳泔铙镬è蝈篝狎珞脲轱骁忡泠骛犰祜鳝雉桢颦脲螬怙澌怙澌ㄤ邈灬蝈ㄩ珙矧骁忡泠骛螬啜戾è痱镢ㄢ艉磲脲翳蝈徜灬礅溽īㄨ犷潇弪汜箦戾舄è泔铙镬瀛轱轱螬í泔铙镬濯磲脲轭篝犷沐с镱箫戾泪蜱螬┅躅鏖钿痱雉邈痱镧棱镤ㄣ祜箦泔铙镬ㄨ钿泔铙镬濯┅┅箦蜷秕蟓泔钿轸轱ㄣㄦ矧磲⑴轸漉麸狺ア悌ㄣ飙躞弪汉聃轸┅┅┅ㄢ艉觑轭翳蝈徜痱镢┅